# Stage 2 : Reverse Engineering the binary

There's a classic stack based buffer overflow in the function receiving the request. Sending a little more than 4096 bytes will crash the child process.

## Bypassing the stack canary

Stack canaries are enabled, however, the value of the cookie can be brute forced as the cookie doesn't change accross forks.
By overwriting one unknown byte of the canary at a time it's value can be brute forced in approximately 128\*4 requests (in practive this is reduced to 128\*3 since the first byte is usually 0 to prevent exploitation of strcpy and similar functions).

See cookiebrute()

## Bypassing ASLR

Arbitrary files can be read using the path traversal bug. Reading /proc/self/maps will allow for an ASLR bypass.

See leakmaps()

## Bypassing NX

No-eXecute (NX) can be bypassed by using a ROP chain.
There are multiple ways to construct the ROP chain. The two most common ways are

- prepare the arguments for system() and jump there
- mmap an rwx memory region and write some shellcode there, then jump there.

Both are implemented in pwn.py

Gadgets can be found using e.g. the [ROPgadget tool](https://github.com/JonathanSalwan/ROPgadget).
